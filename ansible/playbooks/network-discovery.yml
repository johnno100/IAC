# ansible/playbooks/network-discovery.yml
---
- name: Discover Network Configuration
  hosts: all
  gather_facts: true
  tasks:
    - name: Gather network interface information
      ansible.builtin.setup:
        gather_subset:
          - network
      register: network_facts
    
    - name: Save network configuration
      local_action:
        module: copy
        content: "{{ network_facts | to_nice_yaml }}"
        dest: "{{ playbook_dir }}/../inventories/current-state/{{ inventory_hostname }}-network.yml"
        mode: '0644'