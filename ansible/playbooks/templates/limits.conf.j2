# ansible/templates/limits.conf.j2
# System-wide resource limits for Proxmox hosts
# Generated by Ansible on {{ ansible_date_time.date }}

# Security and performance settings for Proxmox VE

# Core file size
* soft core 0
* hard core 0

# Maximum number of processes
* soft nproc 65535
* hard nproc 65535

# Open file descriptors
* soft nofile 131072
* hard nofile 131072

# Maximum locked memory for Ceph
{% if ceph_enabled | default(false) %}
* soft memlock unlimited
* hard memlock unlimited
{% endif %}

# Stack size
* soft stack 8192
* hard stack 8192

# Limits for specific services
root soft nofile 131072
root hard nofile 131072

# VM-related services
ceph soft nofile 131072
ceph hard nofile 131072

qemu soft nofile 131072
qemu hard nofile 131072
qemu soft nproc 4096
qemu hard nproc 16384
{% if ceph_enabled | default(false) %}
qemu soft memlock unlimited
qemu hard memlock unlimited
{% endif %}

# Container-related services
lxc soft nofile 131072
lxc hard nofile 131072
lxc soft nproc 4096
lxc hard nproc 16384